<div class="chat-wrapper">
    <div class="chat-toggle" (click)="toggleChat()">
      <img src="assets/bot.png" class="chat-icon" [class.active]="isChatOpen"/>
      <span class="notification-badge" *ngIf="unreadMessages > 0">{{unreadMessages}}</span>
    </div>
  
    <div class="chat-container" [class.open]="isChatOpen">
      <div class="chat-header">
        <h3>Business Assistant</h3>
        <button class="close-btn" (click)="toggleChat()">Ã—</button>
      </div>
      
      <div class="chat-history" #scrollContainer>
        <div *ngFor="let msg of messages" class="message-row" [ngClass]="msg.user ? 'user-row' : 'bot-row'">
          <img [src]="msg.user ? 'assets/user.png' : 'assets/bot.png'" class="avatar" />
          <div class="message-bubble" [ngClass]="msg.user ? 'user-msg' : 'bot-msg'">
            {{ msg.content }}
          </div>
        </div>
  
        <div *ngIf="isLoading" class="message-row bot-row">
          <img src="assets/bot.png" class="avatar" />
          <div class="message-bubble bot-msg typing-indicator">
            <span></span><span></span><span></span>
          </div>
        </div>
      </div>
  
      <div class="chat-input-container">
        <input
          [(ngModel)]="userInput"
          (keydown.enter)="sendMessage()"
          placeholder="Ask about finance, marketing, or business..."
        />
        <button (click)="sendMessage()" [disabled]="isLoading">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M22 2L11 13M22 2L15 22L11 13M11 13L2 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>