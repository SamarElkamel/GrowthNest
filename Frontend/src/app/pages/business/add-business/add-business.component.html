<div class="add-business-container">
  <h1>Ajouter un Business</h1>
  <form [formGroup]="businessForm" (ngSubmit)="onSubmit()" aria-label="Formulaire d'ajout de business">
    <div class="form-group">
      <label for="name">Nom du Business</label>
      <input
        id="name"
        formControlName="name"
        placeholder="Entrez le nom du business"
        [ngClass]="{
          'invalid': name.touched && name.invalid,
          'valid': name.touched && name.valid
        }"
        aria-required="true"
      />
      <div *ngIf="name.touched && name.invalid" class="error">
        <div *ngIf="name.errors?.['required']">Le nom est requis.</div>
        <div *ngIf="name.errors?.['minlength']">Le nom doit avoir au moins 3 caractères.</div>
        <div *ngIf="name.errors?.['maxlength']">Le nom ne doit pas dépasser 50 caractères.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <input
        id="description"
        formControlName="description"
        placeholder="Entrez la description"
        [ngClass]="{
          'invalid': description.touched && description.invalid,
          'valid': description.touched && description.valid
        }"
        aria-required="true"
      />
      <div *ngIf="description.touched && description.invalid" class="error">
        <div *ngIf="description.errors?.['required']">La description est requise.</div>
        <div *ngIf="description.errors?.['minlength']">La description doit avoir au moins 10 caractères.</div>
        <div *ngIf="description.errors?.['maxlength']">La description ne doit pas dépasser 255 caractères.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="instagramPageName">Nom de la page Instagram</label>
      <input
        id="instagramPageName"
        formControlName="instagramPageName"
        placeholder="Entrez le nom de la page Instagram (optionnel)"
        [ngClass]="{
          'invalid': instagramPageName.touched && instagramPageName.invalid,
          'valid': instagramPageName.touched && instagramPageName.valid
        }"
      />
      <div *ngIf="instagramPageName.touched && instagramPageName.invalid" class="error">
        <div *ngIf="instagramPageName.errors?.['maxlength']">Le nom ne doit pas dépasser 30 caractères.</div>
        <div *ngIf="instagramPageName.errors?.['pattern']">Utilisez uniquement des lettres, chiffres, points ou tirets bas.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="categorieBusiness">Catégorie</label>
      <select id="categorieBusiness" formControlName="categorieBusiness" aria-required="true">
        <option [ngValue]="null" disabled>Sélectionnez une catégorie</option>
        <option *ngFor="let category of categories" [ngValue]="category">{{ category }}</option>
      </select>
      <div *ngIf="categorieBusiness.touched && categorieBusiness.invalid" class="error">
        <div *ngIf="categorieBusiness.errors?.['required']">La catégorie est requise.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="logoInput">Logo</label>
      <input
        id="logoInput"
        type="file"
        accept="image/jpeg,image/png"
        (change)="onLogoSelected($event)"
        style="display: none;"
        aria-label="Sélectionner un logo"
      />
      <button type="button" (click)="triggerFileInput('logo')" [disabled]="isSubmitting">Choisir un logo</button>
      <div *ngIf="logoPreview" class="preview">
        <img [src]="logoPreview" alt="Prévisualisation du logo" style="max-width: 200px;" />
      </div>
    </div>

    <div class="form-group">
      <label for="pdfInput">Document PDF</label>
      <input
        id="pdfInput"
        type="file"
        accept="application/pdf"
        (change)="onPdfSelected($event)"
        style="display: none;"
        aria-label="Sélectionner un PDF"
      />
      <button type="button" (click)="triggerFileInput('pdf')" [disabled]="isSubmitting">Choisir un PDF</button>
      <div *ngIf="pdfName" class="preview">
        <p>Fichier sélectionné : {{ pdfName }}</p>
      </div>
    </div>

    <button type="submit" [disabled]="businessForm.invalid || isSubmitting" aria-label="Ajouter le business">
      {{ isSubmitting ? 'Envoi en cours...' : 'Ajouter le Business' }}
    </button>
  </form>
</div> 